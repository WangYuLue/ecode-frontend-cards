### 1、请用 node 写一个简单的 httpServer

```js
const http = require('http');

http.createServer((request, response) => {
  response.end('Hello World\n');
}).listen(8888);
```

### 2、`__dirname` ，`__filename` ，`process.cwd()` ，`./` 有哪些区别？

- `__dirname`： 获得当前执行文件所在目录的完整目录名
- `__filename`： 获得当前执行文件的带有完整绝对路径的文件名
- `process.cwd()`：获得当前执行node命令时候的文件夹目录名
- `./`： 不使用 `require`时候，`./` 与 `process.cwd()` 一样，使用 `require` 时候，与`__dirname`一样

相关文章：
[Node.js的__dirname，__filename，process.cwd()，./的一些坑](https://github.com/jawil/blog/issues/18)

### 3、CommonJS 和 ES Module 有什么区别？

- CommonJS 模块输出的是一个值的拷贝，而 ES6 Module 输出的是值的引用
- CommonJS 模块是运行时加载，ES6 Module 是编译时输出接口
- CommonJS `this` 指向当前模块，ES6 Module `this` 指向 `undefined`
- 对循环依赖的处理不同。CommonJS 模块是加载时执行，一旦出现某个模块被“循环加载”，会输出已经执行的部分，没有执行的部分不会输出。ES6 Module 对导出模块，变量，对象是动态引用，遇到模块加载命令 `import` 时不会去执行模块，只是生成一个指向被加载模块的引用。

相关链接：

[CommonJS和ES6模块循环加载处理的区别](https://juejin.im/post/6844903747290660878)

### 4、node 中如何使用 ES Modules 导入？

1. 可以使用 `.mjs` 作为文件后缀
1. 对于 node v13 或以上的版本，可以在 `package.json` 中添加 `"type": "module"` 来表示用 `ES Modules` 方式导入模块

### 5、node 中 require 如何导入文件？

- 如果 X 是内置模块（比如 require('http'）)
  - 返回该模块。
  - 不再继续执行。
- 如果 X 以 "./" 或者 "/" 或者 "../" 开头
  - 根据 X 所在的父模块，确定 X 的绝对路径。
  - 将 X 当成文件，依次查找下面文件，只要其中有一个存在，就返回该文件，不再继续执行。

    ```bash
    X
    X.js
    X.json
    X.node
    ```

  - 将 X 当成目录，依次查找下面文件，只要其中有一个存在，就返回该文件，不再继续执行。

    ```bash
    X/package.json（main字段）
    X/index.js
    X/index.json
    X/index.node
    ```

- 如果 X 不带路径
  - 根据 X 所在的父模块，确定 X 可能的安装目录。
  - 依次在每个目录中，将 X 当成文件名或目录名加载。

- 抛出 "not found"

对于不带路径的情况，再举一个详细的例子。

当前脚本文件 `/home/ry/projects/foo.js` 执行了 `require('bar')` ，Node 内部运行过程如下：

首先，确定 x 的绝对路径可能是下面这些位置，依次搜索每一个目录。

```bash
/home/ry/projects/node_modules/bar
/home/ry/node_modules/bar
/home/node_modules/bar
/node_modules/bar
```

搜索时，Node 先将 bar 当成文件名，依次尝试加载下面这些文件，只要有一个成功就返回。

```bash
bar
bar.js
bar.json
bar.node
```

如果都不成功，说明 bar 可能是目录名，于是依次尝试加载下面这些文件。

```bash
bar/package.json（main字段）
bar/index.js
bar/index.json
bar/index.node
```

如果在所有目录中，都无法找到 bar 对应的文件或目录，就抛出一个错误。

参考链接：

[require() 源码解读](http://www.ruanyifeng.com/blog/2015/05/require.html)

### 6、请用 node 写一个简单的文件服务器

```js
const http = require('http');
const url = require('url');
const fs = require('fs');

http.createServer(function (req, res) {
  const query = url.parse(req.url, true);
  const filename = "." + query.pathname;
  fs.readFile(filename, function (err, data) {
    if (err) {
      res.writeHead(404, { 'Content-Type': 'text/html' });
      return res.end("404 Not Found");
    }
    res.writeHead(200, { 'Content-Type': 'text/html' });
    res.write(data);
    return res.end();
  });
}).listen(8080);
```
